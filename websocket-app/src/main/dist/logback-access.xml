<configuration>
	<!-- always a good activate OnConsoleStatusListener -->
	<statusListener class="ch.qos.logback.core.status.OnConsoleStatusListener" />

	<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>%h %l %u %user %date "%r" %s %b</pattern>
		</encoder>
	</appender>

	<if condition='isDefined("LOGGLY_KEY")'>
		<then>
			<appender name="LOGGLY" class="ch.qos.logback.ext.loggly.LogglyAppender">
				<endpointUrl>http://logs-01.loggly.com/inputs/${LOGGLY_KEY}/tag/logback</endpointUrl>
				<pattern>%d{ISO8601} %p %t %c{0}.%M - %m%n</pattern>
			</appender>
			<appender-ref ref="CONSOLE" />
			<appender-ref ref="LOGGLY" />
		</then>
		<else>
			<appender-ref ref="CONSOLE" />
		</else>
	</if>
</configuration>