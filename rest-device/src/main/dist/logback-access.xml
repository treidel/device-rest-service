<configuration>
	<!-- always a good activate OnConsoleStatusListener -->
	<statusListener class="ch.qos.logback.core.status.OnConsoleStatusListener" />

	<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
		<encoder>
			<pattern>%h %l %u [%t] "%r" %s %b "%i{Referer}" "%i{User-Agent}"
			</pattern>
		</encoder>
	</appender>

	<if condition='isDefined("LOGGLY_KEY")'>
		<then>
			<appender name="LOGGLY"
				class="ch.qos.logback.ext.loggly.LogglyBatchAppender">
				<endpointUrl>http://logs-01.loggly.com/inputs/${LOGGLY_KEY}/tag/logback
				</endpointUrl>
				<layout class="ch.qos.logback.access.PatternLayout">
					<pattern>%h %l %u [%t] "%r" %s %b "%i{Referer}" "%i{User-Agent}"
					</pattern>
				</layout>
			</appender>
			<appender-ref ref="CONSOLE" />
			<appender-ref ref="LOGGLY" />
		</then>
		<else>
			<appender-ref ref="CONSOLE" />
		</else>
	</if>
</configuration>
